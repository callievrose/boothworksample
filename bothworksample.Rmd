---
title: "RP Data Analysis Task"
output: html_document
date: '2024-02-16'
---

**Analyses and Conclusions**

Based on the analyses below, we have determined that on average, (a) people do care about receiving a return apology if they are the first to apologize, (b) this preference does not necessarily vary as a function of individual differences in "initiator type," and (c) a return apology is not viewed as a form of forgiveness. Each of our three analyses will be described further below.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(readxl)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(viridis)
```

```{r}

#Loading the data
data <- read_excel("Data - Fall 2023.xlsx", 2)

#Getting rid of NA values and people who did not pass the attention check
data <- data %>%
    filter(!is.na(feelings_youalone)) %>%
    filter(passedattn == "yes")

#Analysis 1: paired t-test
analysis1 <- t.test(data$feelings_youalone, data$feelings_bothyoufirst, paired = TRUE)
analysis1
```

    To answer our first question, we conducted a paired t-test, examining the difference between the feelings_youalone variable and the feelings_bothyoufirst variable within subjects. The purpose of this analysis was to test whether or not subjects would feel differently if they did or did not get a return apology after apologizing first. Our p-value (< 2.2e-16) was well below 0.05, indicating that there was a significant difference between how subjects felt in these two conditions. In fact, subjects felt on average 26.12 points better (on a scale from -30 to 30) when they recieved a return apology. This indicates that people do care whether or not they receive a return apology after being the first to apologize.



```{r}
#Analysis 2: ANOVA

#Creating a new variable that holds the difference for each participant between feelings_bothyoufirst and feelings_youalone
data <- data %>%
    mutate(feelings_difference = feelings_bothyoufirst - feelings_youalone)

#ANOVA analysis on feelings_difference, using initiator_type as groups
analysis2 <- aov(feelings_difference ~ initiator_type, data = data)
summary(analysis2)

#Sanity check: are the means in each group very far apart?
data_never <- data[data$initiator_type == "never", ]
t.test(data_never$feelings_youalone, data_never$feelings_bothyoufirst, paired = TRUE)

data_always <- data[data$initiator_type == "always", ]
t.test(data_always$feelings_youalone, data_always$feelings_bothyoufirst, paired = TRUE)

data_conditional <- data[data$initiator_type == "conditional", ]
t.test(data_conditional$feelings_youalone, data_conditional$feelings_bothyoufirst, paired = TRUE)

    #The means aren't that far apart and sample sizes are very small, so it makes sense that we don't find a significant difference

```
   
    For our second analysis, we ran a within-subjects ANOVA test to determine if caring about a return apology varies as a function of initiator type. Our p-value of 0.566 is greater than 0.05, indicating that the difference between groups is not significant based on our analyses. We calculated the means for each group and discovered that they are relatively close together, and given that the sample size for each group is quite small, the lack of significance in our analysis is unsurprising. However, it's important to note that those in the conditional initiator type had the largest average difference, which makes logical sense—those who care more about getting a return apology relative to not getting one would be more likely to change their actions based on whether they think they'll recieve an apology. Although our results weren't significant, we could investigate this finding further by conducting another experiment with a larger sample size.
    

```{r}
#Analysis 3: paired t-test (forgiveness variable)
analysis3 <- t.test(data$feelings_bothyoufirst, data$feelings_youaloneforgiven, paired = TRUE)
analysis3


```

    For our third analysis, we conducted a paired t-test on feelings_bothyoufirst and feelings_youaloneforgiven to determine whether subjects would feel differently after (a) recieving a return apology, and (b) being forgiven but not recieving a return apology. Our p-value (2.32e-10) was less than 0.05, indicating that the difference between these two variables was significant. On average, participants would rather recieve a return apology than be forgiven but not recieve a return apology (by 21.28 points on a scale from -30 to 30), indicating that a return aplogy is not viewed as a form of forgiveness.


**Plots**

```{r}

#Renaming variables for plot labeling purposes
plot_data <- data %>%
    rename("No Return Apology" = "feelings_youalone",
           "Return Apology" = "feelings_bothyoufirst",
           "Forgiveness, No Apology" = "feelings_youaloneforgiven")

#Plot 1: No return apology vs. return apology

ggpaired(plot_data, "No Return Apology", "Return Apology",
         color = "condition",
         line.color = "grey80",
         palette = c("#e76f51", "#2a9d8f"),
         ylab = "Feelings/n(-30 = extremely negative,\n30 = extremely positive)",
         xlab = "Conditions",
         title = "Feelings on return apologies after being the first to apologize",
         ggtheme = theme_classic()
) +
    labs(color = "Conditions") +
    scale_y_continuous(breaks = seq(-30, 30, by = 10)) 

```

From our first plot, we can see that on average, people think they will feel significantly better if they receive a return apology than if they don't. Interestingly, all of the lines (which indicate which data points from the same participant) are either horizontal or slanting upward, indicating that every single person thought receiving a return apology would be equally or more favorable than not receiving one.


```{r}

#Plot 2: Return apology vs. Forgiveness
ggpaired(plot_data, "Return Apology", "Forgiveness, No Apology",
         color = "condition",
         line.color = "grey90",
         palette = c("#2a9d8f", "#cda052"),
         ylab = "Feelings\n(-30 = extremely negative,\n30 = extremely positive)",
         xlab = "Conditions",
         title = "Feelings on return apologies and forgiveness",
         ggtheme = theme_classic(),
         position = position_nudge(x = -0.2)
) +
    labs(color = "Conditions") +
    scale_y_continuous(breaks = seq(-30, 30, by = 10))

```


Our second plot shows that on average, people much prefer to get a return apology than forgiveness from the other person. However, some individuals prefer forgiveness to an apology, indicating that this preference might be dependent on situational factors, or the values of each individual.

**Possible Psychological Explanations**

The idea of empathy is likely a driving factor behind these results. An apology is a way of demonstrating understanding of someone else's feelings and expressing regret for hurting those feelings, which is an expression of empathy. People like to feel cared for, so they may prefer to receive an apology because it demonstrates care and empathy toward them.

Additionally, the concept of reciprocity may be a factor. When someone apologizes, they want the other person to reciprocate, and will be frustrated if they don't follow this social norm. This might explain why people generally prefer a return apology than just forgiveness, because although forgiveness demonstrates empathy, it does not demonstrate reciprocity.

People also may want others to take responsibility for their actions, and will be frustrated when they don't demonstrate this through apologizing. Especially in situations where someone feels that the other person is to blame, they may be frustrated by a lack of responsibility in addition to or instead of a lack of care/reciprocity.

**Additional Analyses**
To further examine some of these theories, we conducted two additional analyses. 

```{r}
#Additional analysis: reciprocity
t.test(data$feelings_themalone, data$feelings_neither, paired = TRUE)

```

This additional analysis explores whether reciprocity is a driving factor behind our results. From our very first analysis, we found that when people thought they would be 26.12 points happier on average if they received a return apology after apologizing first. However, if the reason that they cared about this was reciprocity, then the difference would not be so large if we compared the conditions where the first participant did not apologize at all. To do this, we looked at the difference between the conditions where only the other person apologized, or neither person apologized. The paired t-test shows that there is a significant different, but the average difference is only 9.4 points, which is much smaller than the difference when the participant apologized first. This indicates that reciprocity may be an important factor.


```{r}

#Additional analysis: blame
data <- data %>%
    mutate(forgiveness_difference = feelings_bothyoufirst - feelings_youaloneforgiven)

ggplot(data, aes(x = blame_1, y = feelings_difference)) +
    geom_point()

ggplot(data, aes(x = blame_1, y = forgiveness_difference)) +
    geom_point()

regression <- lm(feelings_difference ~ blame_1, data = data)
summary(regression)

regression <- lm(forgiveness_difference ~ blame_1, data = data)
summary(regression)
```

Our next additional analysis examines whether blame might influence people's preference regarding return apologies and forgiveness. We hypothesized that if someone believed they themselves were more to blame for the conflict, they would care less about receiving a return apology (in comparison to not receiving one), and they would value forgiveness more (in comparison to receiving a return apology). To test this, we looked at the correlation between blame_1, which measures how much someone believes they are to blame for a conflict, and feelings_difference, which measures how much people care about return apologies. We also looked at the correlation between blame_1 and forgiveness_difference, which measures how much people care about return apologies in comparison to receiving forgiveness but no return apology. However, in both cases the R-squared value was extremely low (.06 and .02), which shows that the correlation between blame and each variable is very weak. We don't have enough evidence to support our hypothesis that blame influences people's preference regarding return apologies and forgiveness.

**Factors that might change the magnitude of the results**
Cultural differences or individual values regarding apologies might lead to smaller or larger effects. For example, if a certain culture or individual deeply values accepting responsibility for one's wrongdoings and demonstrating empathy toward others, those people may place more weight on receiving a return apology than someone who doesn't value those things as much.

Another factor that might change the magnitude of the results is the relationship between the two people. For example, those with closer personal bonds might hold their partners to a higher standard when it comes to apologizing, or expect more empathy and thoughtfulness from them.

These are only a few factors that might affect the magnitude of the results—there are most definitely several more possible factors that would be interesting to explore.


**Task 2: Additional Analyses**

```{r}
#Task 2 Part 1: Bar Graph

category <- c("Participant", "Participant, Other", "Other", "Other, Participant", "Neither", "Participant, Other forgave\nbut did not apologize")

lower_bound <- c(t.test(data$feelings_youalone)$conf.int[1], t.test(data$feelings_bothyoufirst)$conf.int[1], t.test(data$feelings_themalone)$conf.int[1], t.test(data$feelings_boththemfirst)$conf.int[1], t.test(data$feelings_neither)$conf.int[1], t.test(data$feelings_youaloneforgiven)$conf.int[1])

upper_bound <- c(t.test(data$feelings_youalone)$conf.int[2], t.test(data$feelings_bothyoufirst)$conf.int[2], t.test(data$feelings_themalone)$conf.int[2], t.test(data$feelings_boththemfirst)$conf.int[2], t.test(data$feelings_neither)$conf.int[2], t.test(data$feelings_youaloneforgiven)$conf.int[2])

mean <- c(mean(data$feelings_youalone), mean(data$feelings_bothyoufirst), mean(data$feelings_themalone), mean(data$feelings_boththemfirst), mean(data$feelings_neither), mean(data$feelings_youaloneforgiven))

bar_data <- data.frame(category, lower_bound, upper_bound, mean)


#Creating pot (note that we've used the same color palette as the plots above)

ggplot(bar_data, aes(x = reorder(category, -mean), y = mean)) +
    geom_col(aes(fill = category), width = .7) +
    geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound), width = .5) + 
    labs(title = "Comparison of feelings in different apology scenarios",
         fill = "Conditions",
         x = "Conditions",
         y = "Feelings\n(-30 = extremely negative,\n30 = extremely positive)") +
    theme_light() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
    scale_fill_manual(values = c("Other, Participant" = "#264653", "Participant, Other" = "#2a9d8f", "Other" = "#e9c46a", "Participant, Other forgave\nbut did not apologize" = "#cda052", "Neither" = "#f4a261", "Participant" = "#e76f51"),
                      breaks = c("Other, Participant", "Participant, Other", "Other", "Participant, Other forgave\nbut did not apologize", "Neither", "Participant"))

```

In the above plot, we can see that participants had positive feelings toward the conditions where both themselves and the other person apologized, and negative feelings toward every other condition. The three conditions where the other person apologized have the three highest scores, indicating that the other person apologizing is the most important factor to people on average.


```{r}
#Task 2 Part 2: ANOVA

wide_data <- data[,c("feelings_youalone", "feelings_bothyoufirst", "feelings_themalone", "feelings_boththemfirst", "feelings_neither", "feelings_youaloneforgiven")]

# Transform wide data to long format
long_data <- gather(wide_data, key = "type", value = "value")

summary(aov(value ~ type, data = long_data))


#Conducting pairwise t-tests
bothyoufirst_test <- t.test(data$feelings_youalone, data$feelings_bothyoufirst, paired = TRUE)
bothyoufirst_test

themalone_test <- t.test(data$feelings_youalone, data$feelings_themalone, paired = TRUE)
themalone_test

boththemfirst_test <- t.test(data$feelings_youalone, data$feelings_boththemfirst, paired = TRUE)
boththemfirst_test

neither_test <- t.test(data$feelings_youalone, data$feelings_neither, paired = TRUE)
neither_test

youaloneforgiven_test <- t.test(data$feelings_youalone, data$feelings_youaloneforgiven, paired = TRUE)
youaloneforgiven_test

```

The p-value form our one-way ANOVA (<2e-16) is less than 0.05, showing that the there are significant differences in feelings across the six scenarios. Our paired t-tests also all have p-values less than 0.05, showing that there is a significant difference in feeling if you apologize first and don't get a return apology compared with every other type of scenario, although the difference is much greater in the three conditions where the other person apologizes. 


```{r}
#Task 2 Part 3: Proportions

#Creating data table for the visualization
proportion_data <- data.frame(type = c("Participant apologizes,\nthen other apologizes", "Neither apologizes"), proportion = c(37/47, 10/47))

proportion_data$type <- factor(proportion_data$type, levels = c("Participant apologizes,\nthen other apologizes", "Neither apologizes"))

#Creating pie chart
ggplot(proportion_data, aes(x = type, y = proportion, fill = type)) +
    geom_bar(stat = "identity",
             width = .6,
             color = "white",
             position = position_dodge(width = 1),
             ) +
    theme_light() +
    labs(title = "Proportion of people who prefer that\nboth parties apologize or neither apologize",
         y = "Proportion",
         x = "Condition",
         fill = "Condition") +
    scale_fill_manual(values = c("#2a9d8f","#f4a261"))
    

proportion_test <- prop.test(37, 47, p = .5)
proportion_test

```
Since our proportion test had a p-value of less than 0.05, we can determine that the proportions of people who responded with each option are significantly different from each other. Our 95% confidence interval for the proportion who prefer a double apology is [0.64, 0.89], which does not contain .5, indicating that the proportions are not equal. As we can see from the plot, significantly more people prefer that both parties apologize than neither.


